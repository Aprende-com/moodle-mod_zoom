define ("mod_zoom/form",["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={REPEAT_SELECT:"select[name=\"recurrence_type\"]",REPEAT_INTERVAL:".repeat_interval",REPEAT_INTERVAL_DAILY:"#interval_daily",REPEAT_INTERVAL_WEEKLY:"#interval_weekly",REPEAT_INTERVAL_MONTHLY:"#interval_monthly",REPEAT_INTERVAL_OPTIONS:"select[name=\"repeat_interval\"] option",START_TIME:"select[name*=\"start_time\"]",DURATION:"*[name*=\"duration\"]",RECURRING:"input[name=\"recurring\"][type!=\"hidden\"]",OPTION_JBH:"input[name=\"option_jbh\"][type!=\"hidden\"]",OPTION_WAITING_ROOM:"input[name=\"option_waiting_room\"][type!=\"hidden\"]"},f={REPEAT_OPTION_NONE:0,REPEAT_OPTION_DAILY:1,REPEAT_OPTION_WEEKLY:2,REPEAT_OPTION_MONTHLY:3},g={REPEAT_OPTION_DAILY:90,REPEAT_OPTION_WEEKLY:12,REPEAT_OPTION_MONTHLY:3},h=function(){var b=!1,c=parseInt(a(e.REPEAT_SELECT).val(),10);if(a(e.RECURRING).prop("checked")&&c===f.REPEAT_OPTION_NONE){b=!0}a(e.START_TIME).prop("disabled",b);a(e.DURATION).prop("disabled",b)},i=function(){a(e.REPEAT_INTERVAL).hide();var b=parseInt(a(e.REPEAT_SELECT).val(),10);if(b===f.REPEAT_OPTION_DAILY){a(e.REPEAT_INTERVAL_DAILY).show()}else if(b===f.REPEAT_OPTION_WEEKLY){a(e.REPEAT_INTERVAL_WEEKLY).show()}else if(b===f.REPEAT_OPTION_MONTHLY){a(e.REPEAT_INTERVAL_MONTHLY).show()}},j=function(){var b=parseInt(a(e.REPEAT_SELECT).val(),10);a(e.REPEAT_INTERVAL_OPTIONS).each(function(){if(b===f.REPEAT_OPTION_WEEKLY){if(this.value>g.REPEAT_OPTION_WEEKLY){a(this).hide()}}else if(b===f.REPEAT_OPTION_MONTHLY){if(this.value>g.REPEAT_OPTION_MONTHLY){a(this).hide()}}else{a(this).show()}})},k=function(b,c,d,e){this.tabsColumn=b;this.tabsContentColumn=c;this.emptyAlert=e;this.countTabs=d;this.buildTab=function(b){var c=b.tab.element,d=a(".nav-link",c);c.attr("id","tab-"+this.countTabs);a(".tab-name",d).text(b.tab.name);d.attr("href","#link"+this.countTabs);a("li a",this.tabsColumn).removeClass("active");d.addClass("active");return c};this.buildTabContent=function(b){var c=b.tabContent.element;c.attr("id","link"+this.countTabs);a(".tab-pane",this.tabsContentColumn).removeClass("active");c.addClass("active");return c};this.addTab=function(b){var c=this.buildTab(b),d=this.buildTabContent(b);this.emptyAlert.addClass("hidden");a("ul",this.tabsColumn).append(c);a(".tab-content",this.tabsContentColumn).append(d);return{element:c,content:d}};this.deleteTab=function(b){var c=b,d=a(a("a",c).attr("href"));c.remove();d.remove();var e=a("li",this.tabsColumn).length;if(!e){this.emptyAlert.removeClass("hidden")}else{var f=a("li a.active",this.tabsColumn).length;if(!f){a("li:first-child a",this.tabsColumn).trigger("click")}}}},l=function(){this.roomsListColumn=a("#meeting-rooms-list");this.roomsList=a("ul",this.roomsListColumn);this.addBtn=a("#add-room",this.roomsListColumn);this.emptyAlert=a(".empty-alert",this.roomsListColumn);this.deleteBtn=a(".delete-room",this.roomsListColumn);this.roomsDataColumn=a("#meeting-rooms-data");this.roomItemToClone=a("#rooms-list-item").html();this.roomItemDataToClone=a("#rooms-list-item-data").html();this.initialRoomsCount=parseInt(this.roomsListColumn.attr("data-initial-rooms-count"));this.tabsComponent=new k(this.roomsListColumn,this.roomsDataColumn,this.initialRoomsCount,this.emptyAlert);this.init=function(){this.addRoomEvent();this.deleteRoomEvent();var b=a("li",this.roomsListColumn).length;if(b){this.changeRoomNameEvent();this.buildAutocompleteComponents()}else{this.emptyAlert.removeClass("hidden")}};this.addRoomEvent=function(){var b=this;b.addBtn.click(function(){b.tabsComponent.countTabs++;var c="Room "+b.tabsComponent.countTabs,d=a(b.roomItemToClone),e=a(b.roomItemDataToClone),f=b.tabsComponent.countTabs,g="room-name-"+f;a("input[type=text]",e).prev().attr("for",g);a("input[type=text]",e).attr("id",g);a("input[type=text]",e).attr("name",g);a("input[type=text]",e).val(c);a("input[type=text]",e).next().attr("name","rooms["+f+"]");a("input[type=text]",e).next().val(c);var h="participants-"+f;a(".room-participants",e).attr("id",h);a(".room-participants",e).attr("name","roomsparticipants["+f+"][]");var i="groups-"+f;a(".room-groups",e).attr("id",i);a(".room-groups",e).attr("name","roomsgroups["+f+"][]");var j=b.tabsComponent.addTab({tab:{name:c,element:d},tabContent:{element:e}});a("li:last .delete-room",b.roomsList).click(function(){var c=a(this).closest("li");b.tabsComponent.deleteTab(c)});a("input[type=text]",j.content).on("change keyup paste",function(){var b=this.value;a(this).next().val(b);a(".tab-name",j.element).text(this.value)});a("#"+h+" option").each(function(){var b=a(this).attr("value").replace("-","");a(this).attr("value",b)});a("#"+i+" option").each(function(){var b=a(this).attr("value").replace("-","");a(this).attr("value",b)});b.buildAutocompleteComponent(h,"addparticipant");b.buildAutocompleteComponent(i,"addparticipantgroup")})};this.deleteRoomEvent=function(){var b=this;b.deleteBtn.click(function(){var c=a(this).closest("li");b.tabsComponent.deleteTab(c)})};this.changeRoomNameEvent=function(){var b=this;a("li",this.roomsListColumn).each(function(){var c=a(this).attr("id").split("-"),d=c[1];a("input[name=\"room-name-"+d+"\"]",b.roomsDataColumn).on("change keyup paste",function(){var b=this.value;a(this).next().val(b);a("#tab-"+d+" .tab-name").text(this.value)})})};this.buildAutocompleteComponents=function(){var b=this;a(".room-participants",b.roomsDataColumn).each(function(){var c=a(this).attr("id");b.buildAutocompleteComponent(c,"addparticipant")});a(".room-groups",b.roomsDataColumn).each(function(){var c=a(this).attr("id");b.buildAutocompleteComponent(c,"addparticipantgroup")})};this.buildAutocompleteComponent=function(a,e){c.get_strings([{key:e,component:"zoom"},{key:"selectionarea",component:"zoom"}]).then(function(c){var d=c[0],e=c[1];b.enhance("#"+a,!1,"",d,!1,!0,e,!0);return null}).fail(d.exception)}};return{init:function init(){var b=a(e.OPTION_JBH),c=a(e.OPTION_WAITING_ROOM);b.change(function(){if(!0===b.is(":checked")){c.prop("checked",!1)}});c.change(function(){if(!0===c.is(":checked")){b.prop("checked",!1)}});h();i();j();a(e.REPEAT_SELECT).change(function(){h();i();j()});a(e.RECURRING).change(function(){h()});var d=new l;d.init()}}});
//# sourceMappingURL=form.min.js.map
